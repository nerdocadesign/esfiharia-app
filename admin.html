<!-- admin.html -->
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Gerenciamento de Cardápio</title>
</head>
<body>
  <h1>Gerenciamento de Cardápio</h1>

  <form id="cardapioForm">
    <label for="nome">Nome da Categoria:</label>
    <input type="text" id="nomeCategoria" name="nomeCategoria" required>
    <button type="submit">Adicionar Categoria</button>
  </form>

  <h2>Cardápio Atual</h2>
  <pre id="cardapioDisplay"></pre>

  <script>
    const cardapioDisplay = document.getElementById('cardapioDisplay');
    const cardapioForm = document.getElementById('cardapioForm');

    // Função para carregar o cardápio atual
    function carregarCardapio() {
      fetch('/api/cardapio')
        .then(response => response.json())
        .then(data => {
          cardapioDisplay.textContent = JSON.stringify(data, null, 2);
        })
        .catch(error => console.error('Erro ao carregar o cardápio:', error));
    }

    // Função para enviar dados atualizados do cardápio
    cardapioForm.addEventListener('submit', (event) => {
      event.preventDefault();

      const novaCategoria = document.getElementById('nomeCategoria').value;

      fetch('/api/cardapio', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          categorias: [novaCategoria],
          produtos: [],
          header: { nome: 'Nova Esfiharia', imagem: '' },
          textoBotao: 'Meu Pedido'
        })
      })
        .then(response => response.json())
        .then(data => {
          if (data.message) {
            alert('Cardápio atualizado!');
            carregarCardapio(); // Recarrega o cardápio após a atualização
          } else {
            alert('Erro ao atualizar o cardápio.');
          }
        })
        .catch(error => console.error('Erro ao atualizar o cardápio:', error));
    });

    carregarCardapio(); // Carrega o cardápio ao iniciar a página
  </script>
</body>
</html>
