<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cardápio</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://unpkg.com/@supabase/supabase-js@2.8.0/dist/umd/supabase.min.js"></script>
</head>
<body>

  <div id="header">
    <h1 id="nomeEsfiharia"></h1>
    <img id="imagemHeader" alt="Imagem da Esfiharia" />
    <button id="btnPedido"></button>
  </div>

  <div id="categorias">
    <h2>Categorias</h2>
    <div id="listaCategorias"></div>
  </div>

  <div id="produtos">
    <h2>Produtos</h2>
    <table id="listaProdutos">
      <thead>
        <tr>
          <th>Nome</th>
          <th>Preço</th>
          <th>Categoria</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    window.onload = () => {
      // Inicialize o Supabase
      const supabase = createClient('https://ajuzonfhftbknlmzqygw.supabase.co', 'sua-chave-api');

      let categorias = [];
      let produtos = [];
      let header = {};
      let textoBotao = 'Meu Pedido';

      // Carregar os dados do Supabase
      async function carregarDados() {
        const { data, error } = await supabase
          .from('cardapio')
          .select()
          .eq('id', 1)
          .single();

        if (error) {
          console.error('Erro ao carregar dados:', error.message);
          alert('Erro ao carregar os dados. Tente novamente mais tarde.');
          return;
        }

        categorias = data.categorias || [];
        produtos = data.produtos || [];
        header = data.header || {};
        textoBotao = data.textoBotao || 'Meu Pedido';

        // Preencher os dados do header
        document.getElementById('nomeEsfiharia').textContent = header.nome || 'Esfiharia';
        document.getElementById('imagemHeader').src = header.imagem || '';
        document.getElementById('btnPedido').textContent = textoBotao;

        // Atualizar as categorias e produtos
        atualizarCategorias();
        atualizarProdutos();
      }

      // Atualizar lista de categorias
      function atualizarCategorias() {
        const lista = document.getElementById('listaCategorias');
        lista.innerHTML = '';
        categorias.forEach((cat) => {
          const div = document.createElement('div');
          div.textContent = cat;
          lista.appendChild(div);
        });
      }

      // Atualizar lista de produtos
      function atualizarProdutos() {
        const tbody = document.getElementById('listaProdutos').getElementsByTagName('tbody')[0];
        tbody.innerHTML = '';
        produtos.forEach((p) => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${p.nome}</td>
            <td>R$ ${parseFloat(p.preco).toFixed(2)}</td>
            <td>${p.categoria}</td>
          `;
          tbody.appendChild(tr);
        });
      }

      // Carregar os dados assim que a página for carregada
      carregarDados();
    };
  </script>
</body>
</html>

